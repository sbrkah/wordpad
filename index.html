<!DOCTYPE html>
<html lang="en-id">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/x-icon" href="./assets/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
        crossorigin="anonymous" referrerpolicy="no-referrer">
    <title>Wordpad - Susun Kata!</title>
    <style>
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        .box-loading {
            width: 40px;
            height: 40px;
            background: linear-gradient(45deg, #ff6b6b, #ffa726);
            margin: 0 auto;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            animation: randomSizeChange 6s infinite;
        }

        @keyframes randomSizeChange {

            0%,
            20% {
                width: 40px;
                /* 4x4 */
                height: 40px;
                background: #9BDF46;
            }

            21%,
            40% {
                width: 30px;
                /* 3x8 */
                height: 80px;
                background: #719EBD;
            }

            41%,
            60% {
                width: 70px;
                /* 4x4 */
                height: 40px;
                background: #1f2d2c;
            }

            61%,
            80% {
                width: 40px;
                /* 4x6 */
                height: 60px;
                background: #ff5a5a;
            }

            81%,
            100% {
                width: 30px;
                /* 3x3 */
                height: 30px;
                background: #25A55F;
            }
        }

        body.loading {
            overflow: hidden;
        }
    </style>
</head>

<body class="loading">
    <div id="loading-screen">
        <div class="box-loading">

        </div>
    </div>

    <div class="header">
        <div class="header__wrapper">
            <div id="progress-bar"></div>
            <div class="header__content container">
                <div class="header__brand">
                    <img src="./assets/icon.png" alt="Wordpad Logo" />
                    <span>Wordpad</span>
                </div>
                <div class="level-indicator__display">
                    <div class="level-indicator__decorator level-indicator__decorator--flipped">
                        <!-- Font Awesome Icon --> </div>
                    <div id="level-name">Pemula</div>
                    <div class="level-indicator__decorator"> <!-- Font Awesome Icon --> </div>
                </div>
                <div class="header__actions">
                    <div class="tooltip-trigger" id="theme-btn" data-tooltip="Ganti&nbsp;Tema">
                        <i class="fa-solid fa-sun" id="theme-btn__icon"></i>
                        <div class="tooltip">Ganti Tema</div>
                        <br />
                    </div>
                    <div class="tooltip-trigger" id="score-btn" data-tooltip="Skor&nbsp;terbaikmu!">
                        <i class="fa-solid fa-trophy"></i>
                        <div class="tooltip">Papan Skor</div>
                        <br />
                    </div>
                    <!-- <div class="tooltip-trigger" id="share-btn">
                        <i class="fa-solid fa-share-nodes"></i>
                        <div class="tooltip">Menyukai Wordpad? Bagikan pada teman!</div>
                    </div> -->
                    <div class="score-display tooltip-trigger" data-tooltip="">
                        <span><i class="fa-solid fa-circle-dot"></i> <span id="score">0</span></span>
                        <div class="tooltip"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <div class="game-info container">
        <div class="level-indicator">
            <div class="level-indicator__track">
                <div class="progress-track">
                    <div class="progress-track__line"></div>
                    <div class="progress-track__dots">
                        <!-- Progress dots -->
                    </div>
                </div>
            </div>
        </div>

        <div class="words-panel">
            <div id="words-full-view" class="words-panel__expanded">
                <div class="words-panel__header">
                    <i class="fas fa-file-word"></i>
                    <h4>Kata Ditemukan</h4>
                </div>
                <div id="words-list">
                    <!-- word list -->
                </div>
                <div class="words-panel__toggle words-panel__toggle--minimize" id="toggle-minimize"><i
                        class="fas fa-chevron-up"></i></div>
            </div>
            <div id="words-compact-view" class="words-panel__compact">
                <!-- word list -->
                <span>&nbsp</span>
            </div>
            <div class="words-panel__fade"></div>
            <div class="words-panel__toggle" id="toggle-expand"><i class="fas fa-chevron-down"></i></div>
            <div class="words-panel__toggle words-panel__toggle--minimize" id="toggle-collapse"><i
                    class="fas fa-chevron-up"></i></div>
        </div>

        <div id="notification" class="notification">
            <span id="notification-message">Semoga berungga!</span>
        </div>

        <div id="score-modal" class="score-modal">
            <div class="score-modal__header">
                <i class="fa-solid fa-chart-simple"></i>
                Rekor Saya
            </div>
            <div class="score-modal__description">
                <span>Sedewa apa perbendaharaan katamu?!</span>
            </div>
            <div id="score-records" class="score-modal__records line-scrollbar">
                <!-- record item -->
            </div>
            <div class="score-modal__footer">
                <span>*hanya menyimpan rekor game harian</span>
                <div id="close-modal" class="score-modal__close">Tutup</div>
            </div>
        </div>
    </div>

    <div class="game-area container">
        <div class="game-board">
            <div class="input-display">
                <div id="current-input"></div>
                <div class="input-display__cursor"></div>
            </div>
            <div class="keyboard">
                <div class="keyboard__row">
                    <div class="key key--letter" data-letter="T">T</div>
                    <div class="key key--letter" data-letter="E">E</div>
                    <div class="key key--letter" data-letter="S">S</div>
                </div>
                <div class="keyboard__row">
                    <div class="key key--letter" data-letter="L">L</div>
                    <div class="key key--letter key--primary" data-letter="P">P</div>
                    <div class="key key--letter" data-letter="A">A</div>
                </div>
                <div class="keyboard__row">
                    <div class="key key--letter" data-letter="K">K</div>
                    <div class="key key--letter" data-letter="B">B</div>
                    <div class="key key--action" id="delete-key"><i class="fas fa-backspace"></i></div>
                </div>
                <div class="keyboard__row">
                    <div class="key key--action" id="shuffle-key"><i class="fas fa-shuffle"></i></div>
                    <div class="key key--submit" id="submit-key">Submit</div>
                </div>
            </div>
        </div>
    </div>

    <div class="footer container">
        <img src="./assets/decorator.png" alt="image decoration of word" />
        <div class="footer__content">
            Rangkai kata dengan huruf yang disediakan. Kata yang disusun harus mengandung huruf utama.
        </div>
        <div id="app-version" class="footer__version">
            Wordpad v0.51
        </div>
    </div>

    <script src="sha256-uint8array.js"></script>
    <script type="module" src="index.js"></script>
    <!-- Loading Handler -->
    <script>
        class ContentLoader {
            constructor() {
                this.resourcesLoaded = false;
                this.init();
            }

            async init() {
                try {
                    await this.waitForDOM();
                    await this.waitForFonts();
                    await this.waitForIcons();
                    this.completeLoading();
                } catch (error) {
                    console.warn('Loading interrupted:', error);
                    this.completeLoading();
                }
            }

            waitForDOM() {
                return new Promise(resolve => {
                    if (document.readyState !== 'loading') {
                        resolve();
                    } else {
                        document.addEventListener('DOMContentLoaded', resolve);
                    }
                });
            }

            waitForFonts() {
                return new Promise(resolve => {
                    if (document.fonts && document.fonts.ready) {
                        document.fonts.ready.then(resolve);
                    } else {
                        setTimeout(resolve, 100);
                    }
                });
            }

            waitForIcons() {
                return new Promise((resolve, reject) => {
                    const timeout = setTimeout(resolve, 1000);
                    const checkIcons = () => {
                        const faStylesheet = Array.from(document.styleSheets).find(
                            sheet => sheet.href && sheet.href.includes('font-awesome')
                        );

                        if (faStylesheet) {
                            try {
                                const rules = faStylesheet.cssRules || faStylesheet.rules;
                                if (rules && rules.length > 0) {
                                    clearTimeout(timeout);
                                    resolve();
                                    return;
                                }
                            } catch (e) {
                                
                            }
                        }

                        setTimeout(checkIcons, 100);
                    };

                    checkIcons();
                });
            }

            completeLoading() {
                if (this.resourcesLoaded) return;
                this.resourcesLoaded = true;

                document.body.classList.remove('loading');
                document.body.classList.add('loaded');

                const loadingScreen = document.getElementById('loading-screen');
                loadingScreen.style.opacity = '0';

                setTimeout(() => {
                    loadingScreen.remove();
                }, 500);
            }
        }

        // Start loading process
        new ContentLoader();

        // Ultimate fallback
        setTimeout(() => {
            document.body.classList.add('loaded');
            const loadingScreen = document.getElementById('loading-screen');
            if (loadingScreen) loadingScreen.remove();
        }, 8000);
    </script>
</body>